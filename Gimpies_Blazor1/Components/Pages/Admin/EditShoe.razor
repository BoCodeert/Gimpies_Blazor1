@page "/editShoe/{ShoeId:int}"

@using Gimpies_Blazor1.Database.Data
@using Gimpies_Blazor1.Database.Models.Entities
@using Microsoft.EntityFrameworkCore
@inject ApplicationDbContext DbContext
@inject NavigationManager Navigation
@inject IDialogService DialogService
@rendermode InteractiveServer

<AuthorizeView Policy="@UserPolicy.Edit_Shoes">
    <Authorized Context="authContext">
        <h3>Schoenen Bewerken</h3>

        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="alert alert-danger">
                @errorMessage
            </div>
        }

        @if (isDataLoaded)  
        {
            @if (shoeToEdit != null) 
            {
                <EditForm Model="@shoeToEdit" OnValidSubmit="HandleEditShoe">
                    <DataAnnotationsValidator />
                    <ValidationSummary />

                    <div class="mb-3">
                        <label>Merk</label>
                        <InputText id="brand" class="form-control" @bind-Value="@shoeToEdit.Brand.BrandName" />
                    </div>

                    <div class="mb-3">
                        <label>Model</label>
                        <InputText id="model" class="form-control" @bind-Value="@shoeToEdit.Model.ModelName" />
                    </div>

                    <div class="mb-3">
                        <label>Kleur</label>
                        <InputText id="colour" class="form-control" @bind-Value="shoeToEdit.Colour.ColourName" />
                    </div>

                    <div class="mb-3">
                        <label>Maat</label>
                        <InputNumber id="size" class="form-control" @bind-Value="@shoeToEdit.Size.SizeValue" Min="34" Max="50" />
                    </div>

                    <div class="mb-3">
                        <label>Prijs</label>
                        <InputNumber id="value" class="form-control" @bind-Value="@shoeToEdit.Value" />
                    </div>

                    <button type="submit" class="btn btn-primary">Bewerken</button>
                    <button type="button" class="btn btn-primary" @onclick="ReturnToOverview">Annuleren</button>
                </EditForm>
            }
            else
            {
                <p>Schoen niet gevonden.</p>
            }
        }
        else
        {
            <p>De gegevens worden geladen...</p>
        }
    </Authorized>
    <NotAuthorized Context="authContext">
        <h3>Toegang Geweigerd</h3>
        <p>U heeft niet de juiste rechten om deze pagina te bekijken. Neem contact op met de beheerder als u denkt dat dit een fout is.</p>
    </NotAuthorized>
</AuthorizeView>